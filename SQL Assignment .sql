CREATE DATABASE COMPNAY1;
CREATE TABLE DEPT (
    DEPTNO INT PRIMARY KEY,
    DNAME VARCHAR(50) NOT NULL,
    LOC VARCHAR(50) NOT NULL
);

INSERT INTO DEPT (DEPTNO, DNAME, LOC) VALUES
(10, 'ACCOUNTING', 'NEW YORK'),
(20, 'RESEARCH', 'DALLAS'),
(30, 'SALES', 'CHICAGO');

SELECT*FROM DEPT;

CREATE TABLE EMP (
    EMPNO INT PRIMARY KEY,
    ENAME VARCHAR(50) NOT NULL,
    EJOB VARCHAR(50) NOT NULL,
    MGR INT,
    HIREDATE DATE NOT NULL,
    SAL DECIMAL(10, 2) NOT NULL,
    COMM DECIMAL(10, 2),
    DEPTNO INT,
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);

ALTER TABLE EMP RENAME COLUMN NAME TO ENAME;


INSERT INTO EMP (EMPNO,ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO) VALUES
(7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800.00, NULL, 20),
(7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600.00, 300.00, 30),
(7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250.00, 500.00, 30),
(7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975.00, NULL, 20),
(7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250.00, 1400.00, 30),
(7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850.00, NULL, 30),
(7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450.00, NULL, 10),
(7788, 'SCOTT', 'ANALYST', 7566, '1987-04-19', 3000.00, NULL, 20),
(7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000.00, NULL, 10),
(7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500.00, 0.00, 30),
(7876, 'ADAMS', 'CLERK', 7788, '1987-05-23', 1100.00, NULL, 20),
(7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950.00, NULL, 30),
(7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000.00, NULL, 20),
(7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300.00, NULL, 10);

SELECT*FROM EMP;

# 1. List all Employees whose salary is greater than 1,000 but not 2,000. Show the Employee Name, Department and Salary

SELECT EMP.ENAME AS Employee_Name,DEPT.DNAME AS Department_Name,EMP.SAL AS Salary
FROM EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO WHERE EMP.SAL > 1000 AND EMP.SAL < 2000;

# 2. Count the number of people in department 30 who receive a salary and a commission.

SELECT COUNT(*) AS Count FROM EMP WHERE DEPTNO = 30 AND SAL IS NOT NULL AND COMM IS NOT NULL;

# 3. Find the name and salary of the employees that have a salary greater or equal to 1,000 and live in Dallas. 

SELECT EMP.ENAME AS Employee_Name,EMP.SAL AS Salary,LOC
FROM EMP JOIN DEPT ON EMP.DEPTNO = DEPT.DEPTNO WHERE EMP.SAL >= 1000 AND DEPT.LOC = 'DALLAS';

# 4.Find all departments that do not have any current employees. 

SELECT DEPT.DNAME AS Department_Name,DEPT.LOC AS Location FROM DEPT LEFT JOIN EMP ON DEPT.DEPTNO = EMP.DEPTNO
WHERE EMP.EMPNO IS NULL;


# 5.List the department number, the average salary, and the number/count of employees of each department.

SELECT DEPTNO AS Department_Number,AVG(SAL) AS Average_Salary,COUNT(EMPNO) AS Employee_CounT FROM EMP GROUP BY  DEPTNO;


